@(exercise: model.html.HtmlExercise, user: model.Student) @main("HTML-Test", user) {
<script src="@routes.Assets.versioned("javascripts/src-min/ace.js")"></script>

<script type="text/javascript">
  if("WebSocket" in window) {
    // Let us open a web socket
    var ws = new WebSocket("@routes.HTML.getWebSocket().webSocketURL(request)");
    
    ws.onopen = function() {
      // ws.send("Websocket opened!");
    };
    
    ws.onmessage = function(evt) {
      console_write(evt.data);
    };
    
    ws.onclose = function() {
      console_write("Websocket closed!");
    };
  }

  function console_write(msg) {
    var console = document.getElementById("feedBackDiv");
    if(msg == "Keine Fehler") {
      console.innerHTML = "";
      var div = document.createElement("div");
      var att = document.createAttribute("class");
      att.value = "alert alert-success";
      div.setAttributeNode(att);
      div.appendChild(document.createTextNode(msg));
      console.appendChild(div);
    } else {
      console.innerHTML = "";
      var div = document.createElement("div");
      var att = document.createAttribute("class");
      att.value = "alert alert-danger";
      div.setAttributeNode(att);
      var errors = msg.split("\n");
      for(err in errors) {
        paragraph = document.createElement("p");
        paragraph.innerHTML = errors[err];
        div.appendChild(paragraph);
      }
      console.appendChild(div);
    }
  }

  function send() {
    var text = editor.getValue();
    ws.send(text);
    document.getElementById('iframeid').src = document.getElementById('iframeid').src;
  }
</script>

<div class="row">

  <div class="col-sm-12 col-md-6">
    <ul class="nav nav-tabs">
      <li class="active"><a data-toggle="tab" href="#theeditor">Editor</a></li>
      <li><a data-toggle="tab" onclick="send()" href="#loesung">Ihre L&ouml;sung...</a></li>
    </ul>

    <div class="tab-content">
      <div id="theeditor" class="tab-pane in active">
        <div class="panel panel-default">
          <div class="panel-body">
            <div class="form-control" style="height: 500px;" id="editor">@for(line <- exercise.getDefaultInLines) {@line 
}           </div>
            <script>
                          var editor = ace.edit("editor");
                          editor.setTheme("ace/theme/eclipse");
                          editor.getSession().setMode("ace/mode/html");
                          editor.getSession().setTabSize(2);
                          editor.getSession().setUseWrapMode(true);
                          document.getElementById('editor').style.fontSize = '16px';
                        </script>
          </div>
        </div>
      </div>

      <div id="loesung" class="tab-pane">
        <div class="panel panel-default">
          <div class="panel-body">
            <div class="embed-responsive embed-responsive-16by9">
              <iframe id="iframeid" class="embed-responsive-item" src="/html/solution/@user.name"></iframe>
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>

  <div class="col-sm-12 col-md-6">
    <ul class="nav nav-tabs">
      <li class="active"><a data-toggle="tab" href="#aufgabe">Aufgabenstellung</a></li>
      <li><a data-toggle="tab" href="#feedback">Feedback</a></li>
    </ul>

    <div class="tab-content">
      <div id="aufgabe" class="tab-pane in active">
        <div class="panel panel-default">
          <div class="panel-body">
            <!-- TODO: exerciseText! -->
            <p>@exercise.exerciseText</p>
            @for(task <- exercise.getAllTasks) {
            <p>- @task.taskDescription</p>
            }
            <hr>
            <h3>Beispiell&ouml;sung:</h3>
            <img class="img-responsive center-block" src="@routes.Assets.versioned("images/sol1.jpg")" alt="Musterl&ouml;sung" width="640" height="360">
          </div>
        </div>
      </div>

      <div id="feedback" class="tab-pane">
        <div class="panel panel-default">
          <div class="panel-body">
            <h3>//TODO: Feedback...</h3>
          </div>
        </div>
      </div>

    </div>
  </div>
</div>
}
