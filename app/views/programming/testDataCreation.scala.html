@(user: model.User, exercise: model.programming.ProgCompleteEx, oldData: Seq[model.programming.CommitedTestData])

@stdTestSize = @{
    controllers.exes.idPartExes.ProgController.STD_TEST_DATA_COUNT
}

@scripts = {
    <script src="@routes.Assets.versioned("javascripts/programming/testdataCreation.js")"></script>
    <script>
            const INPUT_COUNT = parseInt('@exercise.inputCount');
    </script>
}

@testInputNameAndId(id: Int, testCount: Int) = @{
    "inp_" + id + "_" + testCount
}

@testInputPlaceholder(id: Int, testCount: Int) = @{
    "Test " + (testCount + 1) + ", Input " + (id + 1)
}

@testOutputPlaceholder(id: Int) = @{
    "Test " + (id + 1) + ", Output"
}

@url = @{
    controllers.exes.idPartExes.routes.ProgController.correctLive(exercise.ex.id)
}

@main("Programmierung: Defintion von Testdaten", user, scripts) {

    @core.helperTemplates.modal("Bearbeitungshinweise", "hintsModal", "lg") {
        <ul>
            <li>Hier k&ouml;nnen Sie sich eigene Testdaten definieren, um die Funktion kennenzulernen und zus&auml;tzliche Testdaten zu nutzen.</li>
            <li>Diese k&ouml;nnen gegen eine Musterl&ouml;sung validiert werden.</li>
            <li>Au&szlig;erdem werden Sie automatisch beim Testen ihrer L&ouml;sung verwendet.</li>
        </ul>
    }

    <div class="container">
        <div class="page-header">
            <h1>Definition von Testdaten <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#hintsModal">?</button></h1>
        </div>

        <div class="row">
            <div class="col-md-6">
                <h3>Beschreibung der Funktion</h3>
                @Html(exercise.ex.text)
            </div>

            <div class="col-md-6">

                <form class="form" action="javascript:validateTestData('@url', '@model.programming.TestdataCreation.urlName')">
                    <input title="hidden" hidden type="number" name="inputCount" id="inputCount" value="@exercise.inputCount">
                    <input title="hidden" hidden type="number" name="testCount" id="testCount" value="@Math.max(oldData.size, stdTestSize)">
                    <table class="table" id="testDataTable">
                        <thead>
                            <tr>
                                <th>ID</th>
                                @for(i <- 1 to exercise.inputCount) {
                                    <th>Input @i</th>
                                }
                                <th>Output</th>
                            </tr>
                        </thead>

                        <tbody id="testDataBody">
                            @for(old <- oldData) {
                                <tr id="tr_@old.id" data-testid="@old.id">
                                    <td>@old.id</td>
                                    @*for((input, inputCount) <- Seq.empty/*old.input */ .zipWithIndex) {*@
                                    @*<td>*@
                                    @*<input class="form-control" value="@input" name="inp_@{*@
                                    @*inputCount*@
                                    @*}_@old.id"*@
                                    @*id="inp_@{*@
                                    @*inputCount*@
                                    @*}_@old.id" placeholder="Test @old.id, Input @inputCount">*@
                                    @*</td>*@
                                    @*}*@
                                    <td>
                                        <input class="form-control" value="@old.output" name="outp_@old.id" id="outp_@old.id"
                                        placeholder="@testOutputPlaceholder(old.id)">

                                    </td>
                                </tr>
                            }
                            @for(testCount <- oldData.size until stdTestSize) {
                                <tr id="tr_@testCount" data-testid="@testCount">
                                    <td>@testCount</td>
                                    @for(inputCount <- 0 until exercise.inputCount) {
                                        <td>
                                            <input class="form-control" name="@testInputNameAndId(inputCount, testCount)" id="@testInputNameAndId(inputCount, testCount)"
                                            placeholder="@testInputPlaceholder(inputCount, testCount)">
                                        </td>
                                    }
                                    <td><input class="form-control" name="outp_@testCount" id="outp_@testCount" placeholder="@testOutputPlaceholder(testCount)">
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>

                    <hr>

                    <button type="button" class="btn btn-default btn-block" onclick="moreTestData()">
                        <span class="glyphicon glyphicon-plus"></span> Weitere Testdaten erstellen
                    </button>

                    <hr>

                    <div class="btn-group btn-group-justified">
                        <div class="btn-group">
                            <button class="btn btn-primary">Testdaten validieren</button>
                        </div>
                        <div class="btn-group">
                            <a class="btn btn-success">Testdaten speichern</a>
                        </div>
                    </div>

                </form>
            </div>


        </div>
    </div>
}