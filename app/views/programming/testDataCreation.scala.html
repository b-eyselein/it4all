@(user: model.User, exercise: model.programming.ProgCompleteEx, oldData: Seq[model.programming.CompleteCommitedTestData], toolMainObject: model.programming.ProgrammingToolMain)

@stdTestSize = @{
    model.programming.ProgrammingToolMain.STD_TEST_DATA_COUNT
}

@scripts = {
    @* Javascript Routes *@
    <script type="text/javascript" src="@routes.Application.javascriptRoutes"></script>

    <script src="@routes.Assets.versioned("javascripts/programming/testdataCreation.js")"></script>
    <script>
            const INPUT_COUNT = parseInt('@exercise.inputCount');
    </script>
}

@testInputNameAndId(id: Int, testCount: Int) = @{
    "inp_" + id + "_" + testCount
}

@testInputPlaceholder(id: Int, testCount: Int) = @{
    "Test " + (testCount + 1) + ", Input " + (id + 1)
}

@testOutputPlaceholder(id: Int) = @{
    "Test " + (id + 1) + ", Output"
    0
}

@url = @{
    // FIXME: part...
    controllers.exes.routes.ExerciseController.correctLive("prog", exercise.ex.id, part = "TODO!")
}

@main("Programmierung: Defintion von Testdaten", Some(user), scripts) {

    @core.helperTemplates.modal("Bearbeitungshinweise", "hintsModal", "lg") {
        <ul>
            <li>Hier können Sie sich eigene Testdaten definieren, um die Funktion kennenzulernen und zusätzliche Testdaten zu nutzen.</li>
            <li>Diese können gegen eine Musterlösung validiert werden.</li>
            <li>Außerdem werden Sie automatisch beim Testen ihrer Lösung verwendet.</li>
        </ul>
    }

    <div class="container">
        <div class="page-header">
            <h1>Definition von Testdaten <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#hintsModal">?</button></h1>
        </div>

        <div class="row">
            <div class="col-md-6">
                <h3>Beschreibung der Funktion</h3>
                @Html(exercise.ex.text)

                <div id="messageDiv"></div>

            </div>

            <div class="col-md-6">

                <input title="hidden" hidden id="exerciseId" value="@exercise.id">
                <input title="hidden" hidden id="toolType" value="@toolMainObject.urlPart">
                <input title="hidden" hidden id="exercisePart" value="@model.programming.TestdataCreation.urlName">

                <input title="hidden" hidden type="number" name="inputCount" id="inputCount" value="@exercise.inputCount">
                <input title="hidden" hidden type="number" name="testCount" id="testCount" value="@Math.max(oldData.size, stdTestSize)">

                <table class="table" id="testDataTable">
                    <thead>
                        <tr>
                            <th>ID</th>
                            @for(i <- 1 to exercise.inputCount) {
                                <th>Input @i</th>
                            }
                            <th>Output</th>
                        </tr>
                    </thead>

                    <tbody id="testDataBody">
                        @for(old <- oldData) {
                            <tr id="tr_@old.testData.id" data-testid="@old.testData.id">
                                <td>@old.testData.id</td>
                                @for((input, inputCount) <- old.inputs.zipWithIndex) {
                                    <td>
                                        <input class="form-control" value="@input.input" name="inp_@{
                                            inputCount
                                        }_@old.testData.id"
                                        id="inp_@{
                                            inputCount
                                        }_@old.testData.id" placeholder="Test @old.testData.id, Input @inputCount">
                                    </td>
                                }
                                <td>
                                    <input class="form-control" value="@old.testData.output" name="outp_@old.testData.id" id="outp_@old.testData.id"
                                    placeholder="@testOutputPlaceholder(old.testData.id)">

                                </td>
                            </tr>
                        }
                        @for(testCount <- oldData.size until stdTestSize) {
                            <tr id="tr_@testCount" data-testid="@testCount">
                                <td>@testCount</td>
                                @for(inputCount <- 0 until exercise.inputCount) {
                                    <td>
                                        <input class="form-control" name="@testInputNameAndId(inputCount, testCount)" id="@testInputNameAndId(inputCount, testCount)"
                                        placeholder="@testInputPlaceholder(inputCount, testCount)">
                                    </td>
                                }
                                <td><input class="form-control" name="outp_@testCount" id="outp_@testCount" placeholder="@testOutputPlaceholder(testCount)">
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>

                <hr>

                <button type="button" class="btn btn-default btn-block" onclick="moreTestData()">
                    <span class="glyphicon glyphicon-plus"></span> Weitere Testdaten erstellen
                </button>

                <hr>

                <div class="btn-group btn-group-justified">
                    <div class="btn-group">
                        <button id="testBtn" class="btn btn-primary">Testdaten validieren & speichern</button>
                    </div>
                    <a class="btn btn-default" href="@controllers.exes.routes.ExerciseController.index(toolMainObject.urlPart)">Bearbeitung beenden</a>
                </div>

            </div>


        </div>
    </div>
}