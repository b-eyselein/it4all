<div class="container is-fluid">

  <div class="columns">
    <div class="column is-half-desktop">
      <it4all-exercise-files-editor
        [exerciseFileFragments]="exerciseFiles"
        [mode]="'python'">
      </it4all-exercise-files-editor>
    </div>
    <div class="column is-half-desktop">

      <it4all-tabs>
        <it4all-tab [title]="'Aufgabenstellung'">
          <div class="notification mb-3 is-light-grey">
            <span [innerHTML]="exerciseFragment.text"></span>
          </div>

          <div class="columns">
            <div class="column">
              <button class="button is-link is-fullwidth" [class.is-loading]="isCorrecting" (click)="correct()">
                Korrektur
              </button>
            </div>
            <div class="column">
              <a routerLink="../.." class="button is-dark is-fullwidth">Bearbeiten beenden</a>
            </div>
          </div>
        </it4all-tab>

        <it4all-tab [title]="correctionTabTitle">
          <div class="notification is-dark-warning" *ngIf="isCorrecting">
            Die Korrektur läuft gerade...
          </div>

          <ng-container *ngIf="correctionResult">

            <it4all-solution-saved [solutionSaved]="correctionResult.solutionSaved"></it4all-solution-saved>

            <br>

            <it4all-points-notification [points]="abstractResult.points" [maxPoints]="abstractResult.maxPoints">
            </it4all-points-notification>

            <br>

            <div class="message is-danger" *ngIf="internalErrorResult">
              <div class="message-header">Es gab einen internen Fehler bei der Korrektur:</div>
              <div class="message-body">
                <pre>{{internalErrorResult.msg}}</pre>
              </div>
            </div>

            <div class="columns is-multiline" *ngIf="simplifiedResults && simplifiedResults.length > 0">
              <div class="column is-half-desktop" *ngFor="let simplifiedResult of simplifiedResults">
                <it4all-programming-simplified-result [result]="simplifiedResult">
                </it4all-programming-simplified-result>
              </div>
            </div>

            <div class="content" *ngIf="unitTestResults && unitTestResults.length > 0">
              <ul *ngFor="let unitTestResult of unitTestResults">
                <it4all-programming-unit-test-result [unitTestResult]="unitTestResult">
                </it4all-programming-unit-test-result>
              </ul>
            </div>

            <it4all-programming-normal-result *ngIf="normalResult" [normalResult]="normalResult">
            </it4all-programming-normal-result>
          </ng-container>
        </it4all-tab>

        <it4all-tab [title]="sampleSolutionsTabTitle">
          <div class="buttons">
            <button class="button is-primary is-fullwidth" (click)="toggleSampleSolutions()">
              Musterlösung {{displaySampleSolutions ? 'ausblenden' : 'anzeigen'}}
            </button>
          </div>

          <ng-container *ngIf="displaySampleSolutions">
            <ng-container *ngFor="let sample of sampleSolutions; let lastList = last">
              <div class="mb-3" *ngFor="let exFile of sample.files">
                <it4all-exercise-file-card [exerciseFile]="exFile"></it4all-exercise-file-card>
              </div>

              <br *ngIf="!lastList">
            </ng-container>

          </ng-container>
        </it4all-tab>
      </it4all-tabs>

    </div>
  </div>

</div>
