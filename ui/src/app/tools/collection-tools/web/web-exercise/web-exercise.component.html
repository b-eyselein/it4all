<div class="container is-fluid">

  <div class="columns">
    <div class="column is-half-desktop">
      <it4all-exercise-files-editor [exerciseFileFragments]="exerciseFileFragments" [mode]="'htmlmixed'">
      </it4all-exercise-files-editor>
    </div>

    <div class="column is-half-desktop">

      <it4all-tabs>
        <it4all-tab [title]="'Aufgabenstellung'">
          <div class="notification is-light-grey">
            <div class="content">
              <p>{{exerciseFragment.text}}</p>
              <ol *ngIf="part.id === 'html'">
                <li *ngFor="let task of contentFragment.siteSpec.htmlTasks">
                  {{task.text}}
                </li>
              </ol>
              <p *ngIf="part.id === 'js'">
                Es gibt insgesamt {{contentFragment.siteSpec.jsTaskCount}} Testfälle.
              </p>
            </div>
          </div>

          <div class="columns">
            <div class="column">
              <button class="button is-link is-fullwidth" [class.is-loading]="isCorrecting" (click)="correct()">
                Korrektur
              </button>
            </div>
            <div class="column">
              <a [routerLink]="['../..']" class="button is-dark is-fullwidth">Bearbeiten beenden</a>
            </div>
          </div>
        </it4all-tab>

        <it4all-tab [title]="'Korrektur'">

          <ng-container *ngIf="result">

            <it4all-solution-saved [saved]="basicResult.solutionSaved"></it4all-solution-saved>

            <br>

            <it4all-points-notification [points]="basicResult.points" [maxPoints]="basicResult.maxPoints">
            </it4all-points-notification>

            <br>

            <div class="content">
              <ul *ngIf="result.gradedHtmlTaskResults.length > 0">
                <li *ngFor="let htmlResult of result.gradedHtmlTaskResults">
                  <it4all-html-task-result [htmlResult]="htmlResult"></it4all-html-task-result>
                </li>

                <li *ngFor="let jsResult of result.gradedJsTaskResults">
                  <span [ngClass]="jsResult.success === 'COMPLETE' ? 'has-text-success' : 'has-text-danger'">
                   ({{jsResult.points}} / {{jsResult.maxPoints}})
                    Test {{jsResult.id}} ist {{jsResult.success === 'COMPLETE' ? '' : 'nicht'}} korrekt:
                  </span>

                  {{jsResult | json}}
                </li>
              </ul>
            </div>

          </ng-container>

        </it4all-tab>

        <it4all-tab [title]="'Live-Vorschau'"></it4all-tab>
        <it4all-tab [title]="sampleSolutionsTabTitle">
          <div class="buttons">
            <button class="button is-primary is-fullwidth" (click)="toggleSampleSolutions()">
              Musterlösung {{displaySampleSolutions ? 'ausblenden' : 'anzeigen'}}
            </button>
          </div>

          <ng-container *ngIf="displaySampleSolutions">
            <ng-container *ngFor="let sample of sampleSolutions">
              <ng-container *ngFor="let exFile of sample.files; let last = last">
                <it4all-exercise-file-card [exerciseFile]="exFile"></it4all-exercise-file-card>

                <br *ngIf="!last">
              </ng-container>
            </ng-container>

          </ng-container>
        </it4all-tab>
      </it4all-tabs>

    </div>
  </div>

</div>
